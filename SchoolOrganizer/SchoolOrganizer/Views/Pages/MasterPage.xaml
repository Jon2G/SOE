<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://xamarin.com/schemas/2020/toolkit"
             x:Class="SchoolOrganizer.Views.Pages.MasterPage"
             xmlns:fonts="clr-namespace:SchoolOrganizer.Fonts;assembly=SchoolOrganizer"
             xmlns:viewItems="clr-namespace:SchoolOrganizer.Views.ViewItems;assembly=SchoolOrganizer"
             xmlns:cardViews="clr-namespace:SchoolOrganizer.Views.ViewItems.CardViews;assembly=SchoolOrganizer"
             xmlns:controls="clr-namespace:SchoolOrganizer.Control" xmlns:pages="clr-namespace:SchoolOrganizer.ViewModels.Pages"
             xmlns:scheduleView="clr-namespace:SchoolOrganizer.Views.ViewItems.ScheduleView;assembly=SchoolOrganizer"
             xmlns:pages1="clr-namespace:SchoolOrganizer.Views.Pages;assembly=SchoolOrganizer"
             xmlns:viewPage="clr-namespace:SchoolOrganizer.Views.Pages"
             x:DataType="pages:MasterPageViewModel"
             BackgroundColor="{DynamicResource primaryLightColor}" >
    <ContentPage.BindingContext>
        <pages:MasterPageViewModel/>
    </ContentPage.BindingContext>
    <ContentPage.Resources>


        <ControlTemplate x:Key="TabItemTemplate">
            <Grid>
                <Image
                    x:Name="TabIcon"
                    Grid.Row="0"
                    Margin="6"
                    HeightRequest="24"
                    HorizontalOptions="Center"
                    Source="{TemplateBinding CurrentIcon}"
                    VerticalOptions="Center"
                    WidthRequest="24" />
            </Grid>
        </ControlTemplate>

        <ControlTemplate x:Key="BasketTabItemTemplate">
            <Grid>
                <ImageButton 
                    x:Name="BagBtn"
                    Padding="24"
                    BackgroundColor="{DynamicResource primaryLightColor}"
                    HeightRequest="72"
                    HorizontalOptions="Center"
                    InputTransparent="True"
                    Source="{TemplateBinding CurrentIcon}"
                    VerticalOptions="Start"
                    WidthRequest="72">
                    <ImageButton.CornerRadius>
                        <OnPlatform x:TypeArguments="x:Int32">
                            <On Platform="iOS, UWP" Value="36" />
                            <On Platform="Android" Value="60" />
                        </OnPlatform>
                    </ImageButton.CornerRadius>
                </ImageButton>
            </Grid>
        </ControlTemplate>

        <Style x:Key="TabItemStyle" TargetType="toolkit:TabViewItem">
            <Setter Property="TextColor" Value="#979797" />
            <Setter Property="TextColor" Value="#979797" />
            <Setter Property="TextColorSelected" Value="{DynamicResource secondaryColor}" />
            <Setter Property="Scale" Value="0.85" />
        </Style>

    

    </ContentPage.Resources>

    <Grid IsClippedToBounds="False" RowSpacing="0">
        <ContentView x:Name="BrowserHolder" IsVisible="True"  x:FieldModifier="public" />

        <toolkit:TabView Style="{StaticResource CustomTabStyle}" IsTabStripVisible="True" 
                         x:Name="TabView" x:FieldModifier="public" SelectionChanged="TabView_OnSelectionChanged" IsSwipeEnabled="False">

            <!--  FAVOURITE TAB  -->
            <toolkit:TabViewItem HeightRequest="60" >
                <toolkit:TabViewItem.Icon>
                    <FontImageSource
                        FontFamily="{x:Static fonts:FontelloIcons.Font}"
                        Glyph="{x:Static fonts:FontelloIcons.Cal}"
                        Color="{AppThemeBinding Dark={StaticResource  secondaryLightColor},
                                                Light={StaticResource secondaryTextColor}}" />
                </toolkit:TabViewItem.Icon>
                <viewItems:SchoolGrades x:Name="SchoolGrades"/>
            </toolkit:TabViewItem>

            <!--  HOME TAB  -->
            <toolkit:TabViewItem IsSelected="True"  BadgeText="1" BadgeBackgroundColor="Red" BadgeTextColor="White" 
                ControlTemplate="{StaticResource BasketTabItemTemplate}"
                Style="{StaticResource TabItemStyle}">
                <toolkit:TabViewItem.Icon >
                    <FontImageSource 
                        FontFamily="{x:Static fonts:FontelloIcons.Font}"
                        Glyph="{x:Static fonts:FontelloIcons.Book}"
                        Color="{AppThemeBinding Dark={StaticResource  secondaryTextColor},
                                                Light={StaticResource secondaryLightColor}}" />
                </toolkit:TabViewItem.Icon>

                <Grid>
                    <Grid  Margin="0,0,20,0">
                        <viewPage:TaskFirstPage x:Name="TaskFirstPage" x:FieldModifier="public"/>
                    </Grid>
                    <Grid ColumnDefinitions="10,Auto" HorizontalOptions="End" >
                        <viewItems:TimelineBar Grid.Column="1"/>
                    </Grid>
                </Grid>
            </toolkit:TabViewItem>

            <!--  FINANCE TAB  -->
            <toolkit:TabViewItem HeightRequest="60">
                <toolkit:TabViewItem.Icon>
                    <FontImageSource
                        FontFamily="{x:Static fonts:FontelloIcons.Font}"
                        Glyph="{x:Static fonts:FontelloIcons.Calendar}"
                        Color="{AppThemeBinding Dark={StaticResource  secondaryLightColor},
                                                Light={StaticResource secondaryTextColor}}" />
                </toolkit:TabViewItem.Icon>
                <scheduleView:ScheduleViewMain x:Name="ScheduleViewMain"/>
            </toolkit:TabViewItem>


        </toolkit:TabView>
        <!-- RADIAL MENU FILTER -->
        <Grid        
            HorizontalOptions="End" VerticalOptions="End"
            Margin="0, 0, -50, 50">
            <controls:FilterMenu 
                SelectedCommand="{Binding ItemSelectedCommand}"
                HorizontalOptions="Center" 
                VerticalOptions="Center" />
        </Grid>
    </Grid>

</ContentPage>